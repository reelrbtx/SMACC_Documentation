\hypertarget{classfranka_1_1Robot_1_1Impl}{}\section{franka\+:\+:Robot\+:\+:Impl Class Reference}
\label{classfranka_1_1Robot_1_1Impl}\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}


{\ttfamily \#include $<$robot\+\_\+impl.\+h$>$}



Inheritance diagram for franka\+:\+:Robot\+:\+:Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{classfranka_1_1Robot_1_1Impl__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for franka\+:\+:Robot\+:\+:Impl\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classfranka_1_1Robot_1_1Impl_a091452543a9ef4ce4e347911bc14fbc1}{Impl} (std\+::unique\+\_\+ptr$<$ \hyperlink{classfranka_1_1Network}{Network} $>$ network, size\+\_\+t log\+\_\+size, \hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config} realtime\+\_\+config=\hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943a024bd586d70db805d622b85815bfa0de}{Realtime\+Config\+::k\+Enforce})
\item 
\hyperlink{structfranka_1_1RobotState}{Robot\+State} \hyperlink{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd}{update} (const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$motion\+\_\+command, const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$control\+\_\+command) override
\item 
void \hyperlink{classfranka_1_1Robot_1_1Impl_ace3373a95db9754ab9df732d9b1dd1f6}{throw\+On\+Motion\+Error} (const \hyperlink{structfranka_1_1RobotState}{Robot\+State} \&robot\+\_\+state, uint32\+\_\+t motion\+\_\+id) override
\item 
\hyperlink{structfranka_1_1RobotState}{Robot\+State} \hyperlink{classfranka_1_1Robot_1_1Impl_a0de2609b63c0f9ab6bab6e7180c021bf}{read\+Once} ()
\item 
\hyperlink{classfranka_1_1Robot_ad1dd3dccff6f33691d2c66eaa5ac5a10}{Server\+Version} \hyperlink{classfranka_1_1Robot_1_1Impl_af10ccd204c0d2f1c3ad5b7fd4f72be92}{server\+Version} () const noexcept
\item 
\hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config} \hyperlink{classfranka_1_1Robot_1_1Impl_a60b2747318e7c957834c62e83c204fbc}{realtime\+Config} () const noexcept override
\item 
uint32\+\_\+t \hyperlink{classfranka_1_1Robot_1_1Impl_a2f4073ded9e7ecc118a93d233c0f6ed7}{start\+Motion} (\hyperlink{structresearch__interface_1_1robot_1_1Move_a3e7b80b30bbf01dc902c84402502ebbc}{research\+\_\+interface\+::robot\+::\+Move\+::\+Controller\+Mode} controller\+\_\+mode, \hyperlink{structresearch__interface_1_1robot_1_1Move_a334b8380507154e8042b57fbd3287c0f}{research\+\_\+interface\+::robot\+::\+Move\+::\+Motion\+Generator\+Mode} motion\+\_\+generator\+\_\+mode, const \hyperlink{structresearch__interface_1_1robot_1_1Move_1_1Deviation}{research\+\_\+interface\+::robot\+::\+Move\+::\+Deviation} \&maximum\+\_\+path\+\_\+deviation, const \hyperlink{structresearch__interface_1_1robot_1_1Move_1_1Deviation}{research\+\_\+interface\+::robot\+::\+Move\+::\+Deviation} \&maximum\+\_\+goal\+\_\+pose\+\_\+deviation) override
\item 
void \hyperlink{classfranka_1_1Robot_1_1Impl_a30a3ca95296656edb350c49808c74385}{cancel\+Motion} (uint32\+\_\+t motion\+\_\+id) override
\item 
void \hyperlink{classfranka_1_1Robot_1_1Impl_a024cc4b7994e164a1468b4dd222f80ab}{finish\+Motion} (uint32\+\_\+t motion\+\_\+id, const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$motion\+\_\+command, const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$control\+\_\+command) override
\item 
{\footnotesize template$<$typename T , typename... T\+Args$>$ }\\uint32\+\_\+t \hyperlink{classfranka_1_1Robot_1_1Impl_a6e018e65fddf90613219c2935327f80f}{execute\+Command} (T\+Args...)
\item 
\hyperlink{classfranka_1_1Model}{Model} \hyperlink{classfranka_1_1Robot_1_1Impl_af562b87b6d5d8f7ce271daaa82b88693}{load\+Model} () const
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classbool}{bool} \hyperlink{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}{motion\+Generator\+Running} () const noexcept
\item 
\hyperlink{classbool}{bool} \hyperlink{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}{controller\+Running} () const noexcept
\end{DoxyCompactItemize}
\subsection*{Private Types}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\using \hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{Is\+Base\+Of\+Getter\+Setter} = std\+::is\+\_\+base\+\_\+of$<$ \hyperlink{structresearch__interface_1_1robot_1_1GetterSetterCommandBase}{research\+\_\+interface\+::robot\+::\+Getter\+Setter\+Command\+Base}$<$ T, T\+::k\+Command $>$, T $>$
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\std\+::enable\+\_\+if\+\_\+t$<$ \hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{Is\+Base\+Of\+Getter\+Setter}$<$ T $>$\+::value $>$ \hyperlink{classfranka_1_1Robot_1_1Impl_ac281e9292f59718758b2c9897b004776}{handle\+Command\+Response} (const typename T\+::\+Response \&response) const
\item 
{\footnotesize template$<$typename T $>$ }\\std\+::enable\+\_\+if\+\_\+t$<$!\hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{Is\+Base\+Of\+Getter\+Setter}$<$ T $>$\+::value $>$ \hyperlink{classfranka_1_1Robot_1_1Impl_a939a959d9bb69ad7567d7d3a2aabea3e}{handle\+Command\+Response} (const typename T\+::\+Response \&response) const
\item 
\hyperlink{structresearch__interface_1_1robot_1_1RobotCommand}{research\+\_\+interface\+::robot\+::\+Robot\+Command} \hyperlink{classfranka_1_1Robot_1_1Impl_a4c927a26f2a6eceb352ce3af49d28c37}{send\+Robot\+Command} (const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$motion\+\_\+command, const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$control\+\_\+command) const
\item 
\hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\+\_\+interface\+::robot\+::\+Robot\+State} \hyperlink{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}{receive\+Robot\+State} ()
\item 
void \hyperlink{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7}{update\+State} (const \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\+\_\+interface\+::robot\+::\+Robot\+State} \&robot\+\_\+state)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unique\+\_\+ptr$<$ \hyperlink{classfranka_1_1Network}{Network} $>$ \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\+\_\+}
\item 
\hyperlink{classfranka_1_1Logger}{Logger} \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\+\_\+}
\item 
const \hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config} \hyperlink{classfranka_1_1Robot_1_1Impl_af740b3f1aca49659f5d81501f3c83cad}{realtime\+\_\+config\+\_\+}
\item 
uint16\+\_\+t \hyperlink{classfranka_1_1Robot_1_1Impl_a9e5d9b45a15e1e23dd09e4d2fe272833}{ri\+\_\+version\+\_\+}
\item 
\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Mode} \hyperlink{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}{motion\+\_\+generator\+\_\+mode\+\_\+}
\item 
\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Mode} \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+}
\item 
\hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213}{research\+\_\+interface\+::robot\+::\+Controller\+Mode} \hyperlink{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}{controller\+\_\+mode\+\_\+}
\item 
\hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213}{research\+\_\+interface\+::robot\+::\+Controller\+Mode} \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+}
\item 
uint64\+\_\+t \hyperlink{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}{message\+\_\+id\+\_\+}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 23 of file robot\+\_\+impl.\+h.



\subsection{Member Typedef Documentation}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}\label{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!Is\+Base\+Of\+Getter\+Setter@{Is\+Base\+Of\+Getter\+Setter}}
\index{Is\+Base\+Of\+Getter\+Setter@{Is\+Base\+Of\+Getter\+Setter}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{Is\+Base\+Of\+Getter\+Setter}{IsBaseOfGetterSetter}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
using \hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{franka\+::\+Robot\+::\+Impl\+::\+Is\+Base\+Of\+Getter\+Setter} =  std\+::is\+\_\+base\+\_\+of$<$\hyperlink{structresearch__interface_1_1robot_1_1GetterSetterCommandBase}{research\+\_\+interface\+::robot\+::\+Getter\+Setter\+Command\+Base}$<$T, T\+::k\+Command$>$, T$>$\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 61 of file robot\+\_\+impl.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a091452543a9ef4ce4e347911bc14fbc1}\label{classfranka_1_1Robot_1_1Impl_a091452543a9ef4ce4e347911bc14fbc1}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!Impl@{Impl}}
\index{Impl@{Impl}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{Impl()}{Impl()}}
{\footnotesize\ttfamily franka\+::\+Robot\+::\+Impl\+::\+Impl (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \hyperlink{classfranka_1_1Network}{Network} $>$}]{network,  }\item[{size\+\_\+t}]{log\+\_\+size,  }\item[{\hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config}}]{realtime\+\_\+config = {\ttfamily \hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943a024bd586d70db805d622b85815bfa0de}{Realtime\+Config\+::k\+Enforce}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Definition at line 43 of file robot\+\_\+impl.\+cpp.



References logger\+\_\+, franka\+\_\+gripper\+::move(), network\+\_\+, realtime\+\_\+config\+\_\+, ri\+\_\+version\+\_\+, and update\+State().


\begin{DoxyCode}
44     : \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}\{\hyperlink{namespacefranka__gripper_a1356a87108d2229401d3755bd3e53bdf}{std::move}(network)\}, \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}\{log\_size\}, 
      \hyperlink{classfranka_1_1Robot_1_1Impl_af740b3f1aca49659f5d81501f3c83cad}{realtime\_config\_}\{realtime\_config\} \{
45   \textcolor{keywordflow}{if} (!\hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}) \{
46     \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"libfranka robot: Invalid argument"});
47   \}
48 
49   connect<research\_interface::robot::Connect, research\_interface::robot::kVersion>(*
      \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_},
50                                                                                    &
      \hyperlink{classfranka_1_1Robot_1_1Impl_a9e5d9b45a15e1e23dd09e4d2fe272833}{ri\_version\_});
51   \hyperlink{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7}{updateState}(network\_->udpBlockingReceive<
      \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\_interface::robot::RobotState}>());
52 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a091452543a9ef4ce4e347911bc14fbc1_cgraph}
\end{center}
\end{figure}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a30a3ca95296656edb350c49808c74385}\label{classfranka_1_1Robot_1_1Impl_a30a3ca95296656edb350c49808c74385}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!cancel\+Motion@{cancel\+Motion}}
\index{cancel\+Motion@{cancel\+Motion}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{cancel\+Motion()}{cancelMotion()}}
{\footnotesize\ttfamily void franka\+::\+Robot\+::\+Impl\+::cancel\+Motion (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{motion\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classfranka_1_1RobotControl_a8eb19b5e21e2ac8d9c98bffe2dd9124d}{franka\+::\+Robot\+Control}.



Definition at line 286 of file robot\+\_\+impl.\+cpp.



References controller\+Running(), current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+, current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+, research\+\_\+interface\+::robot\+::k\+Idle, research\+\_\+interface\+::robot\+::k\+Other, motion\+Generator\+Running(), network\+\_\+, and receive\+Robot\+State().


\begin{DoxyCode}
286                                                \{
287   \textcolor{keywordflow}{try} \{
288     executeCommand<research\_interface::robot::StopMove>();
289   \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} CommandException& e) \{
290     \textcolor{keywordflow}{throw} ControlException(e.what());
291   \}
292 
293   \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\_interface::robot::RobotState} robot\_state;
294   \textcolor{keywordflow}{do} \{
295     robot\_state = \hyperlink{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}{receiveRobotState}();
296   \} \textcolor{keywordflow}{while} (\hyperlink{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}{motionGeneratorRunning}() || \hyperlink{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}{controllerRunning}());
297 
298   \textcolor{comment}{// Ignore Move response.}
299   \textcolor{comment}{// TODO (FWA): It is not guaranteed that the Move response won't come later}
300   \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpReceiveResponse<\hyperlink{structresearch__interface_1_1robot_1_1Move}{research\_interface::robot::Move}>(
      motion\_id, [](\textcolor{keyword}{auto}) \{\});
301   \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle};
302   \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213a341b8a8f03cf33821c46aa5c3aad4b7a}{research\_interface::robot::ControllerMode::kOther};
303 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a30a3ca95296656edb350c49808c74385_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}\label{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!controller\+Running@{controller\+Running}}
\index{controller\+Running@{controller\+Running}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{controller\+Running()}{controllerRunning()}}
{\footnotesize\ttfamily \hyperlink{classbool}{bool} franka\+::\+Robot\+::\+Impl\+::controller\+Running (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [noexcept]}}



Definition at line 170 of file robot\+\_\+impl.\+cpp.



References controller\+\_\+mode\+\_\+, and research\+\_\+interface\+::robot\+::k\+External\+Controller.



Referenced by cancel\+Motion(), finish\+Motion(), and start\+Motion().


\begin{DoxyCode}
170                                                  \{
171   \textcolor{keywordflow}{return} \hyperlink{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}{controller\_mode\_} == 
      \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213aae18ec698c6d2260b411166de51e86fe}{research\_interface::robot::ControllerMode::kExternalController}
      ;
172 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a6e018e65fddf90613219c2935327f80f}\label{classfranka_1_1Robot_1_1Impl_a6e018e65fddf90613219c2935327f80f}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!execute\+Command@{execute\+Command}}
\index{execute\+Command@{execute\+Command}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{execute\+Command()}{executeCommand()}}
{\footnotesize\ttfamily template$<$typename T , typename... T\+Args$>$ \\
uint32\+\_\+t franka\+::\+Robot\+::\+Impl\+::execute\+Command (\begin{DoxyParamCaption}\item[{T\+Args...}]{args }\end{DoxyParamCaption})}



Definition at line 265 of file robot\+\_\+impl.\+h.



References generate\+\_\+debs\+::args, and network\+\_\+.


\begin{DoxyCode}
265                                                 \{
266   uint32\_t command\_id = \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpSendRequest<T>(\hyperlink{namespacegenerate__debs_a75f9143e38df82d83b2e8a6f99cae02c}{args}...);
267   \textcolor{keyword}{typename} T::Response response = \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpBlockingReceiveResponse<T>(command\_id);
268   handleCommandResponse<T>(response);
269   \textcolor{keywordflow}{return} command\_id;
270 \}
\end{DoxyCode}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a024cc4b7994e164a1468b4dd222f80ab}\label{classfranka_1_1Robot_1_1Impl_a024cc4b7994e164a1468b4dd222f80ab}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!finish\+Motion@{finish\+Motion}}
\index{finish\+Motion@{finish\+Motion}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{finish\+Motion()}{finishMotion()}}
{\footnotesize\ttfamily void franka\+::\+Robot\+::\+Impl\+::finish\+Motion (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{motion\+\_\+id,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$}]{motion\+\_\+command,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$}]{control\+\_\+command }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classfranka_1_1RobotControl_aae1629178b5eeb5d8e4d41d2f746f2fc}{franka\+::\+Robot\+Control}.



Definition at line 247 of file robot\+\_\+impl.\+cpp.



References controller\+Running(), franka\+::anonymous\+\_\+namespace\{robot\+\_\+impl.\+cpp\}\+::create\+Control\+Exception(), current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+, current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+, franka\+::\+Logger\+::flush(), research\+\_\+interface\+::robot\+::k\+Idle, research\+\_\+interface\+::robot\+::k\+Other, research\+\_\+interface\+::robot\+::\+Move\+::k\+Reflex\+Aborted, logger\+\_\+, research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command\+::motion\+\_\+generation\+\_\+finished, motion\+Generator\+Running(), network\+\_\+, and update().


\begin{DoxyCode}
250                                                                      \{
251   \textcolor{keywordflow}{if} (!\hyperlink{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}{motionGeneratorRunning}() && !\hyperlink{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}{controllerRunning}()) \{
252     \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle};
253     \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213a341b8a8f03cf33821c46aa5c3aad4b7a}{research\_interface::robot::ControllerMode::kOther};
254     \textcolor{keywordflow}{return};
255   \}
256 
257   \textcolor{keywordflow}{if} (motion\_command == \textcolor{keyword}{nullptr}) \{
258     \textcolor{keywordflow}{throw} ControlException(\textcolor{stringliteral}{"libfranka robot: No motion generator command given!"});
259   \}
260   \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\_interface::robot::MotionGeneratorCommand} 
      motion\_finished\_command = *motion\_command;
261   motion\_finished\_command.\hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand_af42f06a136505ab2d62ecd70e4cc0db7}{motion\_generation\_finished} = \textcolor{keyword}{true};
262 
263   \textcolor{comment}{// The TCP response for the finished Move might arrive while the robot state still shows that the}
264   \textcolor{comment}{// motion is running, or afterwards. To handle both situations, we do not process TCP packages in}
265   \textcolor{comment}{// this loop and explicitly wait for the Move response over TCP afterwards.}
266   RobotState robot\_state\{\};
267   \textcolor{keywordflow}{while} (\hyperlink{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}{motionGeneratorRunning}() || \hyperlink{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}{controllerRunning}()) \{
268     robot\_state = \hyperlink{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd}{update}(&motion\_finished\_command, control\_command);
269   \}
270 
271   \textcolor{keyword}{auto} response = \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpBlockingReceiveResponse<
      \hyperlink{structresearch__interface_1_1robot_1_1Move}{research\_interface::robot::Move}>(motion\_id);
272   \textcolor{keywordflow}{if} (response.status == \hyperlink{structresearch__interface_1_1robot_1_1Move_a74e15d249324a1b2d28f0a7cf50dc794aedb741f9f460686f7d799eb503d047f1}{research\_interface::robot::Move::Status::kReflexAborted}
      ) \{
273     \textcolor{keywordflow}{throw} \hyperlink{namespacefranka_1_1anonymous__namespace_02robot__impl_8cpp_03_ad774a35737682bade54336046f9d09b2}{createControlException}(\textcolor{stringliteral}{"Motion finished commanded, but the robot is still
       moving!"},
274                                  response.status, robot\_state.last\_motion\_errors, 
      \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}.\hyperlink{classfranka_1_1Logger_a44b15a95e25dabe93f797c1d9651fb6e}{flush}());
275   \}
276   \textcolor{keywordflow}{try} \{
277     handleCommandResponse<research\_interface::robot::Move>(response);
278   \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} CommandException& e) \{
279     \textcolor{keywordflow}{throw} \hyperlink{namespacefranka_1_1anonymous__namespace_02robot__impl_8cpp_03_ad774a35737682bade54336046f9d09b2}{createControlException}(e.what(), response.status, robot\_state.
      last\_motion\_errors,
280                                  \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}.\hyperlink{classfranka_1_1Logger_a44b15a95e25dabe93f797c1d9651fb6e}{flush}());
281   \}
282   \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle};
283   \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = 
      \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213a341b8a8f03cf33821c46aa5c3aad4b7a}{research\_interface::robot::ControllerMode::kOther};
284 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a024cc4b7994e164a1468b4dd222f80ab_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_ac281e9292f59718758b2c9897b004776}\label{classfranka_1_1Robot_1_1Impl_ac281e9292f59718758b2c9897b004776}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!handle\+Command\+Response@{handle\+Command\+Response}}
\index{handle\+Command\+Response@{handle\+Command\+Response}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{handle\+Command\+Response()}{handleCommandResponse()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::enable\+\_\+if\+\_\+t$<$\hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{Is\+Base\+Of\+Getter\+Setter}$<$T$>$\+::value$>$ franka\+::\+Robot\+::\+Impl\+::handle\+Command\+Response (\begin{DoxyParamCaption}\item[{const typename T\+::\+Response \&}]{response }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line 64 of file robot\+\_\+impl.\+h.



References service\+\_\+node\+\_\+3\+::s.


\begin{DoxyCode}
65                                                 \{
66     \textcolor{keyword}{using namespace }\hyperlink{namespacestd_1_1string__literals}{std::string\_literals};  \textcolor{comment}{// NOLINT(google-build-using-namespace)}
67 
68     \textcolor{keywordflow}{switch} (response.status) \{
69       \textcolor{keywordflow}{case} T::Status::kSuccess:
70         \textcolor{keywordflow}{break};
71       \textcolor{keywordflow}{case} T::Status::kCommandNotPossibleRejected:
72         \textcolor{keywordflow}{throw} CommandException(\textcolor{stringliteral}{"libfranka: "}\hyperlink{namespaceservice__node__3_aa976421a49e0b54f23833423400849ae}{s} + 
      \hyperlink{structresearch__interface_1_1robot_1_1CommandTraits}{research\_interface::robot::CommandTraits<T>::kName} +
73                                \textcolor{stringliteral}{" command rejected: command not possible in the current mode!"});
74       \textcolor{keywordflow}{case} T::Status::kInvalidArgumentRejected:
75         \textcolor{keywordflow}{throw} CommandException(\textcolor{stringliteral}{"libfranka: "}\hyperlink{namespaceservice__node__3_aa976421a49e0b54f23833423400849ae}{s} + 
      \hyperlink{structresearch__interface_1_1robot_1_1CommandTraits}{research\_interface::robot::CommandTraits<T>::kName} +
76                                \textcolor{stringliteral}{" command rejected: invalid argument!"});
77       \textcolor{keywordflow}{default}:
78         \textcolor{keywordflow}{throw} ProtocolException(\textcolor{stringliteral}{"libfranka: Unexpected response while handling "}
      \hyperlink{namespaceservice__node__3_aa976421a49e0b54f23833423400849ae}{s} +
79                                 
      \hyperlink{structresearch__interface_1_1robot_1_1CommandTraits}{research\_interface::robot::CommandTraits<T>::kName} + \textcolor{stringliteral}{"
       command!"});
80     \}
81   \}
\end{DoxyCode}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a939a959d9bb69ad7567d7d3a2aabea3e}\label{classfranka_1_1Robot_1_1Impl_a939a959d9bb69ad7567d7d3a2aabea3e}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!handle\+Command\+Response@{handle\+Command\+Response}}
\index{handle\+Command\+Response@{handle\+Command\+Response}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{handle\+Command\+Response()}{handleCommandResponse()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
std\+::enable\+\_\+if\+\_\+t$<$!\hyperlink{classfranka_1_1Robot_1_1Impl_a42d57d169b53c906439dbbde255c1bae}{Is\+Base\+Of\+Getter\+Setter}$<$T$>$\+::value$>$ franka\+::\+Robot\+::\+Impl\+::handle\+Command\+Response (\begin{DoxyParamCaption}\item[{const typename T\+::\+Response \&}]{response }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Definition at line 84 of file robot\+\_\+impl.\+h.



References receive\+Robot\+State(), service\+\_\+node\+\_\+3\+::s, send\+Robot\+Command(), and update\+State().


\begin{DoxyCode}
85                                                 \{
86     \textcolor{keyword}{using namespace }\hyperlink{namespacestd_1_1string__literals}{std::string\_literals};  \textcolor{comment}{// NOLINT(google-build-using-namespace)}
87 
88     \textcolor{keywordflow}{switch} (response.status) \{
89       \textcolor{keywordflow}{case} T::Status::kSuccess:
90         \textcolor{keywordflow}{break};
91       \textcolor{keywordflow}{case} T::Status::kCommandNotPossibleRejected:
92         \textcolor{keywordflow}{throw} CommandException(\textcolor{stringliteral}{"libfranka: "}\hyperlink{namespaceservice__node__3_aa976421a49e0b54f23833423400849ae}{s} + 
      \hyperlink{structresearch__interface_1_1robot_1_1CommandTraits}{research\_interface::robot::CommandTraits<T>::kName} +
93                                \textcolor{stringliteral}{" command rejected: command not possible in the current mode!"});
94       \textcolor{keywordflow}{default}:
95         \textcolor{keywordflow}{throw} ProtocolException(\textcolor{stringliteral}{"libfranka: Unexpected response while handling "}
      \hyperlink{namespaceservice__node__3_aa976421a49e0b54f23833423400849ae}{s} +
96                                 
      \hyperlink{structresearch__interface_1_1robot_1_1CommandTraits}{research\_interface::robot::CommandTraits<T>::kName} + \textcolor{stringliteral}{"
       command!"});
97     \}
98   \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a939a959d9bb69ad7567d7d3a2aabea3e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_af562b87b6d5d8f7ce271daaa82b88693}\label{classfranka_1_1Robot_1_1Impl_af562b87b6d5d8f7ce271daaa82b88693}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!load\+Model@{load\+Model}}
\index{load\+Model@{load\+Model}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{load\+Model()}{loadModel()}}
{\footnotesize\ttfamily \hyperlink{classfranka_1_1Model}{Model} franka\+::\+Robot\+::\+Impl\+::load\+Model (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Definition at line 305 of file robot\+\_\+impl.\+cpp.



References network\+\_\+.


\begin{DoxyCode}
305                                  \{
306   \textcolor{keywordflow}{return} Model(*\hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_});
307 \}
\end{DoxyCode}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}\label{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!motion\+Generator\+Running@{motion\+Generator\+Running}}
\index{motion\+Generator\+Running@{motion\+Generator\+Running}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{motion\+Generator\+Running()}{motionGeneratorRunning()}}
{\footnotesize\ttfamily \hyperlink{classbool}{bool} franka\+::\+Robot\+::\+Impl\+::motion\+Generator\+Running (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [noexcept]}}



Definition at line 166 of file robot\+\_\+impl.\+cpp.



References research\+\_\+interface\+::robot\+::k\+Idle, and motion\+\_\+generator\+\_\+mode\+\_\+.



Referenced by cancel\+Motion(), finish\+Motion(), franka\+::\+Robot\+::\+Impl\+::handle\+Command\+Response$<$ research\+\_\+interface\+::robot\+::\+Move $>$(), and start\+Motion().


\begin{DoxyCode}
166                                                       \{
167   \textcolor{keywordflow}{return} \hyperlink{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}{motion\_generator\_mode\_} != 
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle};
168 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a0de2609b63c0f9ab6bab6e7180c021bf}\label{classfranka_1_1Robot_1_1Impl_a0de2609b63c0f9ab6bab6e7180c021bf}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!read\+Once@{read\+Once}}
\index{read\+Once@{read\+Once}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{read\+Once()}{readOnce()}}
{\footnotesize\ttfamily \hyperlink{structfranka_1_1RobotState}{Robot\+State} franka\+::\+Robot\+::\+Impl\+::read\+Once (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 86 of file robot\+\_\+impl.\+cpp.



References franka\+::convert\+Robot\+State(), network\+\_\+, and receive\+Robot\+State().


\begin{DoxyCode}
86                                \{
87   \textcolor{comment}{// Delete old data from the UDP buffer.}
88   \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\_interface::robot::RobotState} robot\_state;
89   \textcolor{keywordflow}{while} (\hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->udpReceive<decltype(robot\_state)>(&robot\_state)) \{
90   \}
91 
92   \textcolor{keywordflow}{return} \hyperlink{namespacefranka_a0eaee201f8afdb02f6530269cb581cbb}{convertRobotState}(\hyperlink{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}{receiveRobotState}());
93 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a0de2609b63c0f9ab6bab6e7180c021bf_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a60b2747318e7c957834c62e83c204fbc}\label{classfranka_1_1Robot_1_1Impl_a60b2747318e7c957834c62e83c204fbc}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!realtime\+Config@{realtime\+Config}}
\index{realtime\+Config@{realtime\+Config}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{realtime\+Config()}{realtimeConfig()}}
{\footnotesize\ttfamily \hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config} franka\+::\+Robot\+::\+Impl\+::realtime\+Config (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}, {\ttfamily [noexcept]}}



Implements \hyperlink{classfranka_1_1RobotControl_aca02c0c27b863d4a42e08d541c400832}{franka\+::\+Robot\+Control}.



Definition at line 174 of file robot\+\_\+impl.\+cpp.



References realtime\+\_\+config\+\_\+.


\begin{DoxyCode}
174                                                         \{
175   \textcolor{keywordflow}{return} \hyperlink{classfranka_1_1Robot_1_1Impl_af740b3f1aca49659f5d81501f3c83cad}{realtime\_config\_};
176 \}
\end{DoxyCode}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}\label{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!receive\+Robot\+State@{receive\+Robot\+State}}
\index{receive\+Robot\+State@{receive\+Robot\+State}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{receive\+Robot\+State()}{receiveRobotState()}}
{\footnotesize\ttfamily \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\+\_\+interface\+::robot\+::\+Robot\+State} franka\+::\+Robot\+::\+Impl\+::receive\+Robot\+State (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 132 of file robot\+\_\+impl.\+cpp.



References research\+\_\+interface\+::robot\+::\+Robot\+State\+::message\+\_\+id, message\+\_\+id\+\_\+, network\+\_\+, and update\+State().



Referenced by cancel\+Motion(), handle\+Command\+Response(), read\+Once(), and update().


\begin{DoxyCode}
132                                                                \{
133   \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\_interface::robot::RobotState} latest\_accepted\_state;
134   latest\_accepted\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a803676123685390b8c4d5a3907d16e7c}{message\_id} = \hyperlink{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}{message\_id\_};
135 
136   \textcolor{comment}{// If states are already available on the socket, use the one with the most recent message ID.}
137   \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\_interface::robot::RobotState} received\_state\{\};
138   \textcolor{keywordflow}{while} (\hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->udpReceive(&received\_state)) \{
139     \textcolor{keywordflow}{if} (received\_state.message\_id > latest\_accepted\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a803676123685390b8c4d5a3907d16e7c}{message\_id}) \{
140       latest\_accepted\_state = received\_state;
141     \}
142   \}
143 
144   \textcolor{comment}{// If there was no valid state on the socket, we need to wait.}
145   \textcolor{keywordflow}{while} (latest\_accepted\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a803676123685390b8c4d5a3907d16e7c}{message\_id} == \hyperlink{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}{message\_id\_}) \{
146     received\_state = \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->udpBlockingReceive<decltype(received\_state)>();
147     \textcolor{keywordflow}{if} (received\_state.message\_id > latest\_accepted\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a803676123685390b8c4d5a3907d16e7c}{message\_id}) \{
148       latest\_accepted\_state = received\_state;
149     \}
150   \}
151 
152   \hyperlink{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7}{updateState}(latest\_accepted\_state);
153   \textcolor{keywordflow}{return} latest\_accepted\_state;
154 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a4c927a26f2a6eceb352ce3af49d28c37}\label{classfranka_1_1Robot_1_1Impl_a4c927a26f2a6eceb352ce3af49d28c37}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!send\+Robot\+Command@{send\+Robot\+Command}}
\index{send\+Robot\+Command@{send\+Robot\+Command}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{send\+Robot\+Command()}{sendRobotCommand()}}
{\footnotesize\ttfamily \hyperlink{structresearch__interface_1_1robot_1_1RobotCommand}{research\+\_\+interface\+::robot\+::\+Robot\+Command} franka\+::\+Robot\+::\+Impl\+::send\+Robot\+Command (\begin{DoxyParamCaption}\item[{const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$}]{motion\+\_\+command,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$}]{control\+\_\+command }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 95 of file robot\+\_\+impl.\+cpp.



References current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+, current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+, research\+\_\+interface\+::robot\+::k\+External\+Controller, research\+\_\+interface\+::robot\+::k\+Idle, research\+\_\+interface\+::robot\+::\+Robot\+Command\+::message\+\_\+id, message\+\_\+id\+\_\+, and network\+\_\+.



Referenced by handle\+Command\+Response(), and update().


\begin{DoxyCode}
97                                                                            \{
98   \hyperlink{structresearch__interface_1_1robot_1_1RobotCommand}{research\_interface::robot::RobotCommand} robot\_command\{\};
99   \textcolor{keywordflow}{if} (motion\_command != \textcolor{keyword}{nullptr} || control\_command != \textcolor{keyword}{nullptr}) \{
100     robot\_command.\hyperlink{structresearch__interface_1_1robot_1_1RobotCommand_a0a7700d777ee45295f3c9c93c663e225}{message\_id} = \hyperlink{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}{message\_id\_};
101     \textcolor{keywordflow}{if} (motion\_command != \textcolor{keyword}{nullptr}) \{
102       \textcolor{keywordflow}{if} (\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} ==
103           \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle}
      ) \{
104         \textcolor{keywordflow}{throw} ControlException(
105             \textcolor{stringliteral}{"libfranka robot: Trying to send motion command, but no motion generator running!"});
106       \}
107       robot\_command.motion = *motion\_command;
108     \}
109     \textcolor{keywordflow}{if} (control\_command != \textcolor{keyword}{nullptr}) \{
110       \textcolor{keywordflow}{if} (\hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} !=
111           \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213aae18ec698c6d2260b411166de51e86fe}{research\_interface::robot::ControllerMode::kExternalController}
      ) \{
112         \textcolor{keywordflow}{throw} ControlException(
113             \textcolor{stringliteral}{"libfranka robot: Trying to send control command, but no controller running!"});
114       \}
115       robot\_command.control = *control\_command;
116     \}
117 
118     \textcolor{keywordflow}{if} (\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} !=
119             \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle}
       &&
120         \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} ==
121             \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213aae18ec698c6d2260b411166de51e86fe}{research\_interface::robot::ControllerMode::kExternalController}
       &&
122         (motion\_command == \textcolor{keyword}{nullptr} || control\_command == \textcolor{keyword}{nullptr})) \{
123       \textcolor{keywordflow}{throw} ControlException(\textcolor{stringliteral}{"libfranka robot: Trying to send partial robot command!"});
124     \}
125 
126     \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->udpSend<\hyperlink{structresearch__interface_1_1robot_1_1RobotCommand}{research\_interface::robot::RobotCommand}
      >(robot\_command);
127   \}
128 
129   \textcolor{keywordflow}{return} robot\_command;
130 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a4c927a26f2a6eceb352ce3af49d28c37_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_af10ccd204c0d2f1c3ad5b7fd4f72be92}\label{classfranka_1_1Robot_1_1Impl_af10ccd204c0d2f1c3ad5b7fd4f72be92}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!server\+Version@{server\+Version}}
\index{server\+Version@{server\+Version}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{server\+Version()}{serverVersion()}}
{\footnotesize\ttfamily \hyperlink{classfranka_1_1Robot_ad1dd3dccff6f33691d2c66eaa5ac5a10}{Robot\+::\+Server\+Version} franka\+::\+Robot\+::\+Impl\+::server\+Version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [noexcept]}}



Definition at line 162 of file robot\+\_\+impl.\+cpp.



References ri\+\_\+version\+\_\+.


\begin{DoxyCode}
162                                                            \{
163   \textcolor{keywordflow}{return} \hyperlink{classfranka_1_1Robot_1_1Impl_a9e5d9b45a15e1e23dd09e4d2fe272833}{ri\_version\_};
164 \}
\end{DoxyCode}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a2f4073ded9e7ecc118a93d233c0f6ed7}\label{classfranka_1_1Robot_1_1Impl_a2f4073ded9e7ecc118a93d233c0f6ed7}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!start\+Motion@{start\+Motion}}
\index{start\+Motion@{start\+Motion}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{start\+Motion()}{startMotion()}}
{\footnotesize\ttfamily uint32\+\_\+t franka\+::\+Robot\+::\+Impl\+::start\+Motion (\begin{DoxyParamCaption}\item[{\hyperlink{structresearch__interface_1_1robot_1_1Move_a3e7b80b30bbf01dc902c84402502ebbc}{research\+\_\+interface\+::robot\+::\+Move\+::\+Controller\+Mode}}]{controller\+\_\+mode,  }\item[{\hyperlink{structresearch__interface_1_1robot_1_1Move_a334b8380507154e8042b57fbd3287c0f}{research\+\_\+interface\+::robot\+::\+Move\+::\+Motion\+Generator\+Mode}}]{motion\+\_\+generator\+\_\+mode,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1Move_1_1Deviation}{research\+\_\+interface\+::robot\+::\+Move\+::\+Deviation} \&}]{maximum\+\_\+path\+\_\+deviation,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1Move_1_1Deviation}{research\+\_\+interface\+::robot\+::\+Move\+::\+Deviation} \&}]{maximum\+\_\+goal\+\_\+pose\+\_\+deviation }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classfranka_1_1RobotControl_a4a91a5baea3f7edc7eb094ef8208c065}{franka\+::\+Robot\+Control}.



Definition at line 178 of file robot\+\_\+impl.\+cpp.



References controller\+\_\+mode\+\_\+, controller\+Running(), current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+, current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+, franka\+::\+Logger\+::flush(), franka\+::k\+Cartesian\+Impedance, franka\+::k\+Joint\+Impedance, logger\+\_\+, motion\+\_\+generator\+\_\+mode\+\_\+, motion\+Generator\+Running(), network\+\_\+, and update().


\begin{DoxyCode}
182                                                                              \{
183   \textcolor{keywordflow}{if} (\hyperlink{classfranka_1_1Robot_1_1Impl_aa6b34693c27b529a52f7ea5a607c7252}{motionGeneratorRunning}() || \hyperlink{classfranka_1_1Robot_1_1Impl_ac2d91fb2b9838536bcea8ab1aae4802e}{controllerRunning}()) \{
184     \textcolor{keywordflow}{throw} ControlException(\textcolor{stringliteral}{"libfranka robot: Attempted to start multiple motions!"});
185   \}
186 
187   \textcolor{keywordflow}{switch} (motion\_generator\_mode) \{
188     \textcolor{keywordflow}{case} decltype(motion\_generator\_mode)::\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8a3a31dc92434874cc44c61e876b8bd35f}{kJointPosition}:
189       \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} =
190           decltype(\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_})::
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8a3a31dc92434874cc44c61e876b8bd35f}{kJointPosition};
191       \textcolor{keywordflow}{break};
192     \textcolor{keywordflow}{case} decltype(motion\_generator\_mode)::\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8a729c7783e4ea7890b50022b1194e89d6}{kJointVelocity}:
193       \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} =
194           decltype(\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_})::
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8a729c7783e4ea7890b50022b1194e89d6}{kJointVelocity};
195       \textcolor{keywordflow}{break};
196     \textcolor{keywordflow}{case} decltype(motion\_generator\_mode)::\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8ad05aa68e21654f0d7f3672e6827366b6}{kCartesianPosition}:
197       \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} =
198           decltype(\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_})::
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8ad05aa68e21654f0d7f3672e6827366b6}{kCartesianPosition};
199       \textcolor{keywordflow}{break};
200     \textcolor{keywordflow}{case} decltype(motion\_generator\_mode)::\hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8ad42e39826eabd261aa1d29c15be8e433}{kCartesianVelocity}:
201       \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} =
202           decltype(\hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_})::
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8ad42e39826eabd261aa1d29c15be8e433}{kCartesianVelocity};
203       \textcolor{keywordflow}{break};
204     \textcolor{keywordflow}{default}:
205       \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"libfranka: Invalid motion generator mode given."});
206   \}
207 
208   \textcolor{keywordflow}{switch} (controller\_mode) \{
209     \textcolor{keywordflow}{case} decltype(controller\_mode)::\hyperlink{namespacefranka_a3e20bc77587e2c0c53598753e3f4816baa7cd8fc7552b5b9c50684e57f032d724}{kJointImpedance}:
210       \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = decltype(
      \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_})::\hyperlink{namespacefranka_a3e20bc77587e2c0c53598753e3f4816baa7cd8fc7552b5b9c50684e57f032d724}{kJointImpedance};
211       \textcolor{keywordflow}{break};
212     \textcolor{keywordflow}{case} decltype(controller\_mode)::\hyperlink{namespacefranka_a3e20bc77587e2c0c53598753e3f4816bac2c3f2cf686f3debef77b3049958b488}{kCartesianImpedance}:
213       \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = decltype(
      \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_})::\hyperlink{namespacefranka_a3e20bc77587e2c0c53598753e3f4816bac2c3f2cf686f3debef77b3049958b488}{kCartesianImpedance};
214       \textcolor{keywordflow}{break};
215     \textcolor{keywordflow}{case} decltype(controller\_mode)::\hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213aae18ec698c6d2260b411166de51e86fe}{kExternalController}:
216       \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_} = decltype(
      \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_})::\hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213aae18ec698c6d2260b411166de51e86fe}{kExternalController};
217       \textcolor{keywordflow}{break};
218     \textcolor{keywordflow}{default}:
219       \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"libfranka robot: Invalid controller mode given."});
220   \}
221 
222   \textcolor{keyword}{const} uint32\_t move\_command\_id = executeCommand<research\_interface::robot::Move>(
223       controller\_mode, motion\_generator\_mode, maximum\_path\_deviation, maximum\_goal\_pose\_deviation);
224 
225   RobotState robot\_state\{\};
226   \textcolor{keywordflow}{while} (\hyperlink{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}{motion\_generator\_mode\_} != 
      \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} ||
227          \hyperlink{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}{controller\_mode\_} != \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_}) \{
228     \textcolor{keywordflow}{try} \{
229       \textcolor{keywordflow}{if} (\hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpReceiveResponse<\hyperlink{structresearch__interface_1_1robot_1_1Move}{research\_interface::robot::Move}
      >(
230               move\_command\_id,
231               std::bind(&Robot::Impl::handleCommandResponse<research\_interface::robot::Move>, \textcolor{keyword}{this},
232                         std::placeholders::\_1))) \{
233         \textcolor{keywordflow}{break};
234       \}
235     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} CommandException& e) \{
236       \textcolor{keywordflow}{throw} ControlException(e.what());
237     \}
238 
239     robot\_state = \hyperlink{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd}{update}(\textcolor{keyword}{nullptr}, \textcolor{keyword}{nullptr});
240   \}
241 
242   \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}.\hyperlink{classfranka_1_1Logger_a44b15a95e25dabe93f797c1d9651fb6e}{flush}();
243 
244   \textcolor{keywordflow}{return} move\_command\_id;
245 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a2f4073ded9e7ecc118a93d233c0f6ed7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_ace3373a95db9754ab9df732d9b1dd1f6}\label{classfranka_1_1Robot_1_1Impl_ace3373a95db9754ab9df732d9b1dd1f6}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!throw\+On\+Motion\+Error@{throw\+On\+Motion\+Error}}
\index{throw\+On\+Motion\+Error@{throw\+On\+Motion\+Error}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{throw\+On\+Motion\+Error()}{throwOnMotionError()}}
{\footnotesize\ttfamily void franka\+::\+Robot\+::\+Impl\+::throw\+On\+Motion\+Error (\begin{DoxyParamCaption}\item[{const \hyperlink{structfranka_1_1RobotState}{Robot\+State} \&}]{robot\+\_\+state,  }\item[{uint32\+\_\+t}]{motion\+\_\+id }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classfranka_1_1RobotControl_a796e9fb049ffc36ea44bec85f24e2fe4}{franka\+::\+Robot\+Control}.



Definition at line 68 of file robot\+\_\+impl.\+cpp.



References controller\+\_\+mode\+\_\+, franka\+::anonymous\+\_\+namespace\{robot\+\_\+impl.\+cpp\}\+::create\+Control\+Exception(), current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+, current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+, franka\+::\+Logger\+::flush(), franka\+::k\+Move, franka\+::\+Robot\+State\+::last\+\_\+motion\+\_\+errors, logger\+\_\+, motion\+\_\+generator\+\_\+mode\+\_\+, network\+\_\+, and franka\+::\+Robot\+State\+::robot\+\_\+mode.


\begin{DoxyCode}
68                                                                                     \{
69   \textcolor{keywordflow}{if} (robot\_state.robot\_mode != \hyperlink{namespacefranka_adfe059ae23ebbad59e421edaa879651aae54c7412401b5e36c1c254e6fb17a3dd}{RobotMode::kMove} ||
70       \hyperlink{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}{motion\_generator\_mode\_} != 
      \hyperlink{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}{current\_move\_motion\_generator\_mode\_} ||
71       \hyperlink{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}{controller\_mode\_} != \hyperlink{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}{current\_move\_controller\_mode\_}) \{
72     \textcolor{comment}{// We detect a move error by changes in the robot state and we will receive a TCP response to}
73     \textcolor{comment}{// the Move command.}
74     \textcolor{keyword}{auto} response =
75         \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpBlockingReceiveResponse<
      \hyperlink{structresearch__interface_1_1robot_1_1Move}{research\_interface::robot::Move}>(motion\_id);
76     \textcolor{keywordflow}{try} \{
77       handleCommandResponse<research\_interface::robot::Move>(response);
78     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} CommandException& e) \{
79       \textcolor{keywordflow}{throw} \hyperlink{namespacefranka_1_1anonymous__namespace_02robot__impl_8cpp_03_ad774a35737682bade54336046f9d09b2}{createControlException}(e.what(), response.status, robot\_state.
      last\_motion\_errors,
80                                    \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}.\hyperlink{classfranka_1_1Logger_a44b15a95e25dabe93f797c1d9651fb6e}{flush}());
81     \}
82     \textcolor{keywordflow}{throw} ProtocolException(\textcolor{stringliteral}{"Unexpected reply to a Move command"});
83   \}
84 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_ace3373a95db9754ab9df732d9b1dd1f6_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd}\label{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!update@{update}}
\index{update@{update}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily \hyperlink{structfranka_1_1RobotState}{Robot\+State} franka\+::\+Robot\+::\+Impl\+::update (\begin{DoxyParamCaption}\item[{const \hyperlink{structresearch__interface_1_1robot_1_1MotionGeneratorCommand}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Command} $\ast$}]{motion\+\_\+command,  }\item[{const \hyperlink{structresearch__interface_1_1robot_1_1ControllerCommand}{research\+\_\+interface\+::robot\+::\+Controller\+Command} $\ast$}]{control\+\_\+command }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Implements \hyperlink{classfranka_1_1RobotControl_a5b581e84547a76ad1600158345cfd40d}{franka\+::\+Robot\+Control}.



Definition at line 54 of file robot\+\_\+impl.\+cpp.



References franka\+::convert\+Robot\+State(), franka\+::\+Logger\+::log(), logger\+\_\+, network\+\_\+, receive\+Robot\+State(), and send\+Robot\+Command().



Referenced by finish\+Motion(), and start\+Motion().


\begin{DoxyCode}
56                                                                      \{
57   \hyperlink{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}{network\_}->tcpThrowIfConnectionClosed();
58 
59   \hyperlink{structresearch__interface_1_1robot_1_1RobotCommand}{research\_interface::robot::RobotCommand} robot\_command =
60       \hyperlink{classfranka_1_1Robot_1_1Impl_a4c927a26f2a6eceb352ce3af49d28c37}{sendRobotCommand}(motion\_command, control\_command);
61 
62   RobotState state = \hyperlink{namespacefranka_a0eaee201f8afdb02f6530269cb581cbb}{convertRobotState}(\hyperlink{classfranka_1_1Robot_1_1Impl_a15161988fd2644aa2757e196e4488b38}{receiveRobotState}());
63   \hyperlink{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}{logger\_}.\hyperlink{classfranka_1_1Logger_aee4bfea6a4081c4ed9ee2abd2f62a0cd}{log}(state, robot\_command);
64 
65   \textcolor{keywordflow}{return} state;
66 \}
\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classfranka_1_1Robot_1_1Impl_a961bcad42d2be61ff56b7004498fa8dd_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7}\label{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!update\+State@{update\+State}}
\index{update\+State@{update\+State}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{update\+State()}{updateState()}}
{\footnotesize\ttfamily void franka\+::\+Robot\+::\+Impl\+::update\+State (\begin{DoxyParamCaption}\item[{const \hyperlink{structresearch__interface_1_1robot_1_1RobotState}{research\+\_\+interface\+::robot\+::\+Robot\+State} \&}]{robot\+\_\+state }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 156 of file robot\+\_\+impl.\+cpp.



References research\+\_\+interface\+::robot\+::\+Robot\+State\+::controller\+\_\+mode, controller\+\_\+mode\+\_\+, research\+\_\+interface\+::robot\+::\+Robot\+State\+::message\+\_\+id, message\+\_\+id\+\_\+, research\+\_\+interface\+::robot\+::\+Robot\+State\+::motion\+\_\+generator\+\_\+mode, and motion\+\_\+generator\+\_\+mode\+\_\+.



Referenced by handle\+Command\+Response(), Impl(), and receive\+Robot\+State().


\begin{DoxyCode}
156                                                                                 \{
157   \hyperlink{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}{motion\_generator\_mode\_} = robot\_state.
      \hyperlink{structresearch__interface_1_1robot_1_1RobotState_acc1b53a916cd01f1ad39924df4487ec4}{motion\_generator\_mode};
158   \hyperlink{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}{controller\_mode\_} = robot\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a1f198a1ead6a28ed3c0481468597eb53}{controller\_mode};
159   \hyperlink{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}{message\_id\_} = robot\_state.\hyperlink{structresearch__interface_1_1robot_1_1RobotState_a803676123685390b8c4d5a3907d16e7c}{message\_id};
160 \}
\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classfranka_1_1Robot_1_1Impl_a79e762e0bc2fe77fdfe7614963883be7_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}\label{classfranka_1_1Robot_1_1Impl_aa435885c35275fc60b8de90832ae24df}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!controller\+\_\+mode\+\_\+@{controller\+\_\+mode\+\_\+}}
\index{controller\+\_\+mode\+\_\+@{controller\+\_\+mode\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{controller\+\_\+mode\+\_\+}{controller\_mode\_}}
{\footnotesize\ttfamily \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213}{research\+\_\+interface\+::robot\+::\+Controller\+Mode} franka\+::\+Robot\+::\+Impl\+::controller\+\_\+mode\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
      \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213a341b8a8f03cf33821c46aa5c3aad4b7a}{research\_interface::robot::ControllerMode::kOther}
\end{DoxyCode}


Definition at line 116 of file robot\+\_\+impl.\+h.



Referenced by controller\+Running(), start\+Motion(), throw\+On\+Motion\+Error(), and update\+State().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}\label{classfranka_1_1Robot_1_1Impl_ab5d1a7e855dae2453635da08440c375e}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+@{current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+}}
\index{current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+@{current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+}{current\_move\_controller\_mode\_}}
{\footnotesize\ttfamily \hyperlink{namespaceresearch__interface_1_1robot_a54ee0c8bfefd2ee8a46837ca6d2b1213}{research\+\_\+interface\+::robot\+::\+Controller\+Mode} franka\+::\+Robot\+::\+Impl\+::current\+\_\+move\+\_\+controller\+\_\+mode\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 118 of file robot\+\_\+impl.\+h.



Referenced by cancel\+Motion(), finish\+Motion(), send\+Robot\+Command(), start\+Motion(), and throw\+On\+Motion\+Error().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}\label{classfranka_1_1Robot_1_1Impl_a2fecb29212c55738e284b2ba8249ad5c}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+@{current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+}}
\index{current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+@{current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+}{current\_move\_motion\_generator\_mode\_}}
{\footnotesize\ttfamily \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Mode} franka\+::\+Robot\+::\+Impl\+::current\+\_\+move\+\_\+motion\+\_\+generator\+\_\+mode\+\_\+\hspace{0.3cm}{\ttfamily [private]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
      \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8af5137a026a4b2f3b1c8a21cfc60dd14b}{research\_interface::robot::MotionGeneratorMode::kIdle}
\end{DoxyCode}


Definition at line 114 of file robot\+\_\+impl.\+h.



Referenced by cancel\+Motion(), finish\+Motion(), send\+Robot\+Command(), start\+Motion(), and throw\+On\+Motion\+Error().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}\label{classfranka_1_1Robot_1_1Impl_a404078ee04a4786f61d991b71d2dc1ff}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!logger\+\_\+@{logger\+\_\+}}
\index{logger\+\_\+@{logger\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{logger\+\_\+}{logger\_}}
{\footnotesize\ttfamily \hyperlink{classfranka_1_1Logger}{Logger} franka\+::\+Robot\+::\+Impl\+::logger\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 108 of file robot\+\_\+impl.\+h.



Referenced by finish\+Motion(), Impl(), start\+Motion(), throw\+On\+Motion\+Error(), and update().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}\label{classfranka_1_1Robot_1_1Impl_aed154fce2f3a44a60b7397405974d395}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!message\+\_\+id\+\_\+@{message\+\_\+id\+\_\+}}
\index{message\+\_\+id\+\_\+@{message\+\_\+id\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{message\+\_\+id\+\_\+}{message\_id\_}}
{\footnotesize\ttfamily uint64\+\_\+t franka\+::\+Robot\+::\+Impl\+::message\+\_\+id\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 119 of file robot\+\_\+impl.\+h.



Referenced by receive\+Robot\+State(), send\+Robot\+Command(), and update\+State().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}\label{classfranka_1_1Robot_1_1Impl_a209c353b4da1c85d3e633cab161a0d39}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!motion\+\_\+generator\+\_\+mode\+\_\+@{motion\+\_\+generator\+\_\+mode\+\_\+}}
\index{motion\+\_\+generator\+\_\+mode\+\_\+@{motion\+\_\+generator\+\_\+mode\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{motion\+\_\+generator\+\_\+mode\+\_\+}{motion\_generator\_mode\_}}
{\footnotesize\ttfamily \hyperlink{namespaceresearch__interface_1_1robot_abd2451eb963a1843f1eb066ebd4b06e8}{research\+\_\+interface\+::robot\+::\+Motion\+Generator\+Mode} franka\+::\+Robot\+::\+Impl\+::motion\+\_\+generator\+\_\+mode\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 113 of file robot\+\_\+impl.\+h.



Referenced by motion\+Generator\+Running(), start\+Motion(), throw\+On\+Motion\+Error(), and update\+State().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}\label{classfranka_1_1Robot_1_1Impl_acecf3b158ccd1c2ed7e76971f1e6a192}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!network\+\_\+@{network\+\_\+}}
\index{network\+\_\+@{network\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{network\+\_\+}{network\_}}
{\footnotesize\ttfamily std\+::unique\+\_\+ptr$<$\hyperlink{classfranka_1_1Network}{Network}$>$ franka\+::\+Robot\+::\+Impl\+::network\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 106 of file robot\+\_\+impl.\+h.



Referenced by cancel\+Motion(), execute\+Command(), finish\+Motion(), Impl(), load\+Model(), read\+Once(), receive\+Robot\+State(), franka\+::\+Robot\+::\+Impl\+::execute\+Command$<$ research\+\_\+interface\+::robot\+::\+Get\+Cartesian\+Limit, int32\+\_\+t, Virtual\+Wall\+Cuboid $\ast$ $>$(), send\+Robot\+Command(), start\+Motion(), throw\+On\+Motion\+Error(), and update().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_af740b3f1aca49659f5d81501f3c83cad}\label{classfranka_1_1Robot_1_1Impl_af740b3f1aca49659f5d81501f3c83cad}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!realtime\+\_\+config\+\_\+@{realtime\+\_\+config\+\_\+}}
\index{realtime\+\_\+config\+\_\+@{realtime\+\_\+config\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{realtime\+\_\+config\+\_\+}{realtime\_config\_}}
{\footnotesize\ttfamily const \hyperlink{namespacefranka_aeede4f4629390fea21ca5e5a35a8a943}{Realtime\+Config} franka\+::\+Robot\+::\+Impl\+::realtime\+\_\+config\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 110 of file robot\+\_\+impl.\+h.



Referenced by Impl(), and realtime\+Config().

\mbox{\Hypertarget{classfranka_1_1Robot_1_1Impl_a9e5d9b45a15e1e23dd09e4d2fe272833}\label{classfranka_1_1Robot_1_1Impl_a9e5d9b45a15e1e23dd09e4d2fe272833}} 
\index{franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}!ri\+\_\+version\+\_\+@{ri\+\_\+version\+\_\+}}
\index{ri\+\_\+version\+\_\+@{ri\+\_\+version\+\_\+}!franka\+::\+Robot\+::\+Impl@{franka\+::\+Robot\+::\+Impl}}
\subsubsection{\texorpdfstring{ri\+\_\+version\+\_\+}{ri\_version\_}}
{\footnotesize\ttfamily uint16\+\_\+t franka\+::\+Robot\+::\+Impl\+::ri\+\_\+version\+\_\+\hspace{0.3cm}{\ttfamily [private]}}



Definition at line 111 of file robot\+\_\+impl.\+h.



Referenced by Impl(), and server\+Version().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
smacc\+\_\+sm\+\_\+reference\+\_\+library/sm\+\_\+panda\+\_\+moveit/libfranka/src/\hyperlink{robot__impl_8h}{robot\+\_\+impl.\+h}\item 
smacc\+\_\+sm\+\_\+reference\+\_\+library/sm\+\_\+panda\+\_\+moveit/libfranka/src/\hyperlink{robot__impl_8cpp}{robot\+\_\+impl.\+cpp}\end{DoxyCompactItemize}
